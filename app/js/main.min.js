(()=>{var __webpack_modules__={"./app/js/main.js":()=>{eval("const url = 'https://v6.exchangerate-api.com/v6/';\r\nconst key = 'dd8fac2b8f50d5031a77e3e1';\r\nconst input = document.querySelector('#have-input');\r\nconst output = document.querySelector('#get-input');\r\nconst allCurrenciesBox = document.querySelector('.all-currencies');\r\nconst allCurrencies = document.querySelector('.all-currencies__list');\r\nconst symbolFrom = document.querySelector('#symbol-from');\r\nconst symbolTo = document.querySelector('#symbol-to');\r\n\r\nconst currencyFromBtn = document.querySelector('#show-currencies_from');\r\nconst currencyToBtn = document.querySelector('#show-currencies_to');\r\nconst changeValueBtn = document.querySelector('.converter__change');\r\n\r\nlet currenciesData;\r\nlet countriesInfo;\r\nlet exchangeCurrencyTemp;\r\n\r\n\r\nasync function getCurrencies() {\r\n\r\n  if (currenciesData) {\r\n    return currenciesData;\r\n  };\r\n\r\n  let currencyTo = currencyToBtn.dataset.value;\r\n\r\n  try {\r\n    const response = await fetch(`${url}${key}/latest/${currencyTo}`);\r\n    const res = await response.json();\r\n\r\n    currenciesData = res;\r\n    return currenciesData;\r\n\r\n\r\n  } catch (error) {\r\n    console.log(error);\r\n  };\r\n};\r\n\r\nasync function getСountriesInfo() {\r\n\r\n  if (countriesInfo) {\r\n    return countriesInfo;\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(` https://restcountries.com/v3.1/all`);\r\n    const res = await response.json();\r\n    countriesInfo = {};\r\n\r\n    for (k of res) {\r\n      let currencies = k.currencies;\r\n      let flag = k.flags.png;\r\n\r\n      for (j in currencies) {\r\n        countriesInfo[j] = {};\r\n        countriesInfo[j].flag = flag;\r\n        countriesInfo[j].name = currencies[j].name;\r\n        countriesInfo[j].symbol = currencies[j].symbol;\r\n      };\r\n    };\r\n\r\n    return countriesInfo;\r\n  } catch (error) {\r\n    console.log(error);\r\n  };\r\n};\r\n\r\nasync function currencyCalc(exchangeСur, exchangeToСur, inputFrom, inputTo) {\r\n  const data = await getCurrencies();\r\n  const dataCurrency = data.conversion_rates;\r\n\r\n  let result = (parseFloat(inputFrom.value) / dataCurrency[exchangeСur]) * dataCurrency[exchangeToСur];\r\n  let formattedResult = result.toFixed(2);\r\n\r\n\r\n  inputTo.value = formattedResult;\r\n};\r\n\r\nasync function currencyRender() {\r\n  const data = await getCurrencies();\r\n  const countriesData = await getСountriesInfo();\r\n  const dataCurrency = data.conversion_rates;\r\n\r\n\r\n  const commonKeys = Object.keys(dataCurrency).filter(k => k in countriesData);\r\n\r\n  allCurrencies.innerHTML = '';\r\n  commonKeys.forEach(k => {\r\n    let item = document.createElement('li');\r\n    item.className = 'all-currencies__item';\r\n    item.dataset.value = k;\r\n    item.dataset.symbol = countriesData[k].symbol;\r\n\r\n    item.innerHTML = `${k} <span class=\"all-currencies__name\">${countriesData[k].name}</span>\r\n               <img class=\"all-currencies__flag\" src=\"${countriesData[k].flag}\" alt=\"country flag\">`;\r\n\r\n    allCurrencies.append(item);\r\n  });\r\n};\r\n\r\nfunction swapAndUpdate(element1, element2, property, textElement1, textElement2) {\r\n  [element1.dataset[property], element2.dataset[property]] = [element2.dataset[property], element1.dataset[property]];\r\n  textElement1.textContent = element1.dataset[property];\r\n  textElement2.textContent = element2.dataset[property];\r\n};\r\n\r\nfunction inputValidation(input) {\r\n  let value = input.value;\r\n  value = value.replace(/[^0-9.,]/g, '');\r\n\r\n  if (value.length > 1) {\r\n    if (value[0] === '0' && (value[1] === '.' || value[1] === ',')) {\r\n      input.value = value;\r\n    } else if (value[0] === '0') {\r\n      input.value = value.substring(1);\r\n    };\r\n  };\r\n};\r\n\r\n\r\nchangeValueBtn.addEventListener('click', () => {\r\n  swapAndUpdate(currencyFromBtn, currencyToBtn, 'value', currencyFromBtn, currencyToBtn);\r\n  swapAndUpdate(currencyFromBtn, currencyToBtn, 'symbol', symbolFrom, symbolTo);\r\n\r\n  [input.value, output.value] = [output.value, input.value];\r\n});\r\n\r\nallCurrenciesBox.addEventListener('click', (e) => {\r\n  let target = e.target;\r\n  if (target.tagName !== 'LI') {\r\n    allCurrenciesBox.classList.remove('to-show');\r\n    return;\r\n  }\r\n\r\n  const button = exchangeCurrencyTemp === 'from' ? currencyFromBtn : currencyToBtn;\r\n  const сurrencySymbol = exchangeCurrencyTemp === 'from' ? symbolFrom : symbolTo;\r\n  let targetValue = target.dataset.value;\r\n  let targetSymbol = target.dataset.symbol;\r\n\r\n  button.dataset.value = targetValue;\r\n  button.textContent = targetValue;\r\n  button.dataset.symbol = targetSymbol;\r\n  сurrencySymbol.textContent = targetSymbol;\r\n\r\n  allCurrenciesBox.classList.remove('to-show');\r\n  currencyCalc(currencyFromBtn.dataset.value, currencyToBtn.dataset.value, input, output);\r\n});\r\n\r\ncurrencyFromBtn.addEventListener('click', function () {\r\n  allCurrenciesBox.classList.toggle('to-show');\r\n  exchangeCurrencyTemp = this.dataset.temp;\r\n});\r\n\r\ncurrencyToBtn.addEventListener('click', function () {\r\n  allCurrenciesBox.classList.toggle('to-show');\r\n  exchangeCurrencyTemp = this.dataset.temp;\r\n});\r\n\r\ninput.addEventListener('input', function () {\r\n  inputValidation(this);\r\n  currencyCalc(currencyFromBtn.dataset.value, currencyToBtn.dataset.value, input, output);\r\n});\r\n\r\noutput.addEventListener('input', function () {\r\n  inputValidation(this);\r\n  currencyCalc(currencyToBtn.dataset.value, currencyFromBtn.dataset.value, output, input);\r\n});\r\n\r\n\r\ncurrencyRender();\r\ncurrencyCalc(currencyFromBtn.dataset.value, currencyToBtn.dataset.value, input, output);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n//# sourceURL=webpack://prototip_gulp/./app/js/main.js?")}},__webpack_exports__={};__webpack_modules__["./app/js/main.js"]()})();